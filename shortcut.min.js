/* 0.1.1 создание, изменение и удаление €рлычка

cscript shortcut.min.js <location> <name> <target> [<argument> [<directory> [<description> [<icon> [<style> [<hotkey>]]]]]]

<location>      - путь к существующей папке, в которой нужно создать €рлычок (доступны ключи WshSpecialFolder)
<name>          - им€ €рлычка без расширени€, при несовпадении регистра €рлычок переименовываетс€
<target>        - путь к папке или файлу, на который создаЄтс€ €рлычок, при отсутствие целевого объекта €рлычок удал€етс€ (доступны ключи WshSpecialFolder)
<argument>      - аргументы целевого объекта, одинарные кавычки замен€ютс€ двойными
<directory>     - путь к существующей рабочей папке (доступны ключи WshSpecialFolder)
<description>   - описание €рлычка, которое записываетс€ в подсказку
<icon>          - путь к файлу и индекс иконки отделЄнный зап€той
<style>         - целое число, как стиль запуска окна приложени€
<hotkey>        - комбинаци€ гор€чих клавиш

*/

(function(t,d){var b=0;var g=new ActiveXObject("WScript.Shell");d=new ActiveXObject("Scripting.FileSystemObject");if(!b)for(var p=0,w=t.arguments.length;p<w;p++){var a=t.arguments.item(p);switch(p){case 0:var m=a;break;case 1:var q=a;break;case 2:var k=a;break;case 3:var n=a;break;case 4:var h=a;break;case 5:var u=a;break;case 6:var r=a;break;case 7:var l=a;break;case 8:var v=a}}b||((a=m?g.specialFolders(m):null)?m=a:(a=g.expandEnvironmentStrings(m),a=d.getAbsolutePathName(a)),d.folderExists(a)||
d.fileExists(a)||(b=1));b||(a=/[\\\/:\*\?"<>\|]/,q&&!a.test(q))||(b=2);if(!b){a=d.buildPath(m,q+".lnk");var c=g.createShortcut(a)}if(!b&&((a=k?g.specialFolders(k):null)?k=a:(a=g.expandEnvironmentStrings(k),a=d.getAbsolutePathName(a)),!d.folderExists(a)&&!d.fileExists(a))){if(c.targetPath)try{d.deleteFile(c.fullName)}catch(f){}b=3}!b&&n&&(n=n.split("'").join('"'));!b&&h&&((a=h?g.specialFolders(h):null)?h=a:(a=g.expandEnvironmentStrings(h),a=d.getAbsolutePathName(a)),d.folderExists(a)||(b=4));if(!b&&
l)switch(l){case "1":case "3":case "7":l*=1;break;default:b=5}if(!b&&"undefined"!=typeof k&&(a=g.expandEnvironmentStrings(k),a=d.getAbsolutePathName(a).toLowerCase(),c.targetPath.toLowerCase()!=a))try{c.targetPath=k;var e=!0}catch(f){b=6}if(!b&&"undefined"!=typeof n&&c.arguments!=n)try{c.arguments=n,e=!0}catch(f){b=7}if(!b&&"undefined"!=typeof h&&c.workingDirectory!=h)try{c.workingDirectory=h,e=!0}catch(f){b=8}if(!b&&"undefined"!=typeof r&&(a=~r.indexOf(",")?r.split(", ").join(","):r+",0",c.iconLocation!=
a))try{c.iconLocation=a,e=!0}catch(f){b=9}if(!b&&"undefined"!=typeof l&&(a=l?l:1,c.windowStyle!=a))try{c.windowStyle=a,e=!0}catch(f){b=10}if(!b&&"undefined"!=typeof v&&c.hotkey!=v)try{c.hotkey=v,e=!0}catch(f){b=11}if(!b&&"undefined"!=typeof u&&c.description!=u)try{c.description=u,e=!0}catch(f){b=12}if(!b&&e)try{c.save()}catch(f){b=13}if(!b&&(a=q+".lnk",e=d.getFile(c.fullName),e.name!=a)){a=d.buildPath(m,a);try{d.moveFile(e.path,a)}catch(f){b=14}}t.quit(b)})(WSH);
